{
    "type": [
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        3,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        2,
        3,
        3,
        3,
        3,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        0,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        0,
        1,
        2,
        0,
        1,
        3,
        3,
        0,
        1,
        2,
        2,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        2,
        2,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        3,
        0,
        1,
        2,
        3,
        3,
        3,
        0,
        1,
        2,
        2,
        3,
        3,
        3,
        3,
        2
    ],
    "data": [
        "\nR version 4.1.0 (2021-05-18) -- \"Camp Pontanezen\"\nCopyright (C) 2021 The R Foundation for Statistical Computing\nPlatform: x86_64-pc-linux-gnu (64-bit)\n\nR es un software libre y viene sin GARANTIA ALGUNA.\nUsted puede redistribuirlo bajo ciertas circunstancias.\nEscriba 'license()' o 'licence()' para detalles de distribucion.\n\nR es un proyecto colaborativo con muchos contribuyentes.\nEscriba 'contributors()' para obtener más información y\n'citation()' para saber cómo citar R o paquetes de R en publicaciones.\n\n",
        "Escriba 'demo()' para demostraciones, 'help()' para el sistema on-line de ayuda,\no 'help.start()' para abrir el sistema de ayuda HTML con su navegador.\nEscriba 'q()' para salir de R.\n\n",
        "> ",
        "# Script to calculate zcNDVI",
        "> ",
        "# by frzambra",
        "> ",
        "# April 2022",
        "> ",
        "",
        "> ",
        "product <- 'NDVI.MOD13Q1.006/'",
        "> ",
        "",
        "> ",
        "dir <- paste0('/mnt/HDD4TB_2/data/rasters/Procesados/MODIS/',product)",
        "> ",
        "dir.ph <- '/mnt/HDD4TB_2/data/rasters/Procesados/MODIS/Phenology/'",
        "> ",
        "",
        "> ",
        "library(stars)",
        "Loading required package: abind\n",
        "Loading required package: sf\n",
        "Linking to GEOS 3.9.0, GDAL 3.2.2, PROJ 7.2.1; sf_use_s2() is TRUE\n",
        "> ",
        "library(terra)",
        "terra 1.5.21\n",
        "> ",
        "library(sf)",
        "> ",
        "library(snow)",
        "> ",
        "",
        "> ",
        "pol <- st_read('data/spatial/chile_continental.gpkg')",
        "Reading layer `chile_continental' from data source \n  `/mnt/0FA1FA650427517A/OneDrive/R-projects/drought-vegetation/data/spatial/chile_continental.gpkg' \n  using driver `GPKG'\nSimple feature collection with 1 feature and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -75.68856 ymin: -55.97945 xmax: -66.41828 ymax: -17.49849\nGeodetic CRS:  WGS 84\n",
        "> ",
        "pol <- st_transform(pol,32719)",
        "> ",
        "lf <- list.files(dir,pattern='*.tif$', full.names=TRUE)",
        "> ",
        "#",
        "> ",
        "ysize = 100",
        "> ",
        "sliceY <- seq(3580,22015,ysize)",
        "> ",
        "",
        "> ",
        "source('R/functions/cumRast.R')",
        "> ",
        "source('R/functions/getPerPixel.R')",
        "> ",
        "source('R/functions/smoothNDVI.R')",
        "> ",
        "",
        "> ",
        "sos <- st_as_stars(disagg(rast(file.path(dir.ph,'SOS.Chile.S1.500m.tif')),2))",
        "> ",
        "eos <- st_as_stars(disagg(rast(file.path(dir.ph,'EOS.Chile.S1.500m.tif')),2))",
        "> ",
        "",
        "> ",
        "cl <- makeCluster(11,\"SOCK\")",
        "> ",
        "",
        "> ",
        "lapply(1:length(sliceY),function(i){",
        "+ ",
        "  rasterio <- list(nXOff = 6088, nYOff = sliceY[i]+1, nXSize = 3081, nYSize = ysize)",
        "+ ",
        "  ",
        "+ ",
        "  ndvi <- read_stars(lf, along ='dates',RasterIO = rasterio)",
        "+ ",
        "  sosC <- st_crop(sos,ndvi)",
        "+ ",
        "  eosC <- st_crop(eos,ndvi)",
        "+ ",
        "  ",
        "+ ",
        "  dates <- as.Date(substr(lf,67,74),\"%Y%j\")",
        "+ ",
        "  ",
        "+ ",
        "  message('Suavizado NDVI...')",
        "+ ",
        "  NDVI_smooth <- st_apply(ndvi,1:2,smoothNDVI,n=5,CLUSTER = cl,PROGRESS = TRUE,.fname = 'dates')",
        "+ ",
        "  NDVI_smooth <- st_as_stars(NDVI_smooth) ",
        "+ ",
        "  NDVI_smooth <- merge(split(NDVI_smooth,'dates'),name='dates')",
        "+ ",
        "  ",
        "+ ",
        "  ",
        "+ ",
        "  esNDVI <- c(c(sosC,eosC,along = 'dates'),NDVI_smooth, along = 'dates')",
        "+ ",
        "  ",
        "+ ",
        "  rm(NDVI_smooth)",
        "+ ",
        "  gc()",
        "+ ",
        "  ",
        "+ ",
        "  message('Acmulado NDVI..')",
        "+ ",
        "  cNDVI <- st_apply(esNDVI,1:2,cumRast,dates = dates, step = 16,CLUSTER = cl,PROGRESS = TRUE,.fname = 'dates')",
        "+ ",
        "  cNDVI <- merge(split(cNDVI,'dates'),name='dates')",
        "+ ",
        "  ",
        "+ ",
        "  rm(esNDVI)",
        "+ ",
        "  gc()",
        "+ ",
        "  ",
        "+ ",
        "  message('Obteniendo cNDVI en SOS..')",
        "+ ",
        "  secNDVI <- c(c(sosC,eosC,along ='dates'),cNDVI,along='dates')",
        "+ ",
        "  soscNDVI <- st_apply(secNDVI,1:2,getPerPixel,dates = dates, at='eos',lead=0,step = 16,CLUSTER = cl,PROGRESS = TRUE,.fname = 'dates')",
        "+ ",
        "  soscNDVI <- merge(split(soscNDVI,'dates'),name='dates')",
        "+ ",
        "  ",
        "+ ",
        "  rm(secNDVI)",
        "+ ",
        "  gc()",
        "+ ",
        "  ",
        "+ ",
        "  message('Scale cNDVI en SOS..')",
        "+ ",
        "  zcNDVI <- st_apply(soscNDVI,1:2,function(x){scale(x)[,1]},CLUSTER = cl,PROGRESS = TRUE,.fname = 'zcNDVI')",
        "+ ",
        "  zcNDVI <- merge(split(zcNDVI,'zcNDVI'),name='zcNDVI')",
        "+ ",
        "",
        "+ ",
        "  ",
        "+ ",
        "  saveRDS(zcNDVI,paste0('~/.starstemp/zcNDVI_',i,'.rds'))",
        "+ ",
        "  rm(zcNDVI)",
        "+ ",
        "  gc()",
        "+ ",
        "})",
        "Suavizado NDVI...\n",
        "\r  |                                                  | 0 % ~calculating  \r  |+                                                 | 1 % ~22s          \r  |+                                                 | 2 % ~19s          \r  |++                                                | 3 % ~20s          \r  |++                                                | 4 % ~20s          \r  |+++                                               | 5 % ~19s          \r  |+++                                               | 6 % ~18s          ",
        "\r  |++++                                              | 7 % ~18s          \r  |++++                                              | 8 % ~18s          \r  |+++++                                             | 9 % ~17s          \r  |+++++                                             | 10% ~17s          \r  |++++++                                            | 11% ~17s          \r  |++++++                                            | 12% ~17s          \r  |+++++++                                           | 13% ~17s          ",
        "\r  |+++++++                                           | 14% ~16s          \r  |++++++++                                          | 15% ~16s          \r  |++++++++                                          | 16% ~16s          \r  |+++++++++                                         | 17% ~16s          \r  |+++++++++                                         | 18% ~16s          \r  |++++++++++                                        | 19% ~16s          \r  |++++++++++                                        | 20% ~16s          ",
        "\r  |+++++++++++                                       | 21% ~16s          \r  |+++++++++++                                       | 22% ~15s          \r  |++++++++++++                                      | 23% ~15s          \r  |++++++++++++                                      | 24% ~15s          \r  |+++++++++++++                                     | 25% ~15s          \r  |+++++++++++++                                     | 26% ~15s          \r  |++++++++++++++                                    | 27% ~14s          ",
        "\r  |++++++++++++++                                    | 28% ~14s          \r  |+++++++++++++++                                   | 29% ~14s          \r  |+++++++++++++++                                   | 30% ~14s          \r  |++++++++++++++++                                  | 31% ~13s          \r  |++++++++++++++++                                  | 32% ~13s          \r  |+++++++++++++++++                                 | 33% ~13s          \r  |+++++++++++++++++                                 | 34% ~13s          ",
        "\r  |++++++++++++++++++                                | 35% ~12s          \r  |++++++++++++++++++                                | 36% ~12s          \r  |+++++++++++++++++++                               | 37% ~12s          \r  |+++++++++++++++++++                               | 38% ~12s          \r  |++++++++++++++++++++                              | 39% ~12s          \r  |++++++++++++++++++++                              | 40% ~12s          \r  |+++++++++++++++++++++                             | 41% ~11s          ",
        "\r  |+++++++++++++++++++++                             | 42% ~11s          \r  |++++++++++++++++++++++                            | 43% ~11s          \r  |++++++++++++++++++++++                            | 44% ~11s          \r  |+++++++++++++++++++++++                           | 45% ~11s          \r  |+++++++++++++++++++++++                           | 46% ~10s          \r  |++++++++++++++++++++++++                          | 47% ~10s          \r  |++++++++++++++++++++++++                          | 48% ~10s          ",
        "\r  |+++++++++++++++++++++++++                         | 49% ~10s          \r  |+++++++++++++++++++++++++                         | 50% ~10s          \r  |++++++++++++++++++++++++++                        | 51% ~09s          \r  |++++++++++++++++++++++++++                        | 52% ~09s          \r  |+++++++++++++++++++++++++++                       | 53% ~09s          \r  |+++++++++++++++++++++++++++                       | 54% ~09s          \r  |++++++++++++++++++++++++++++                      | 55% ~09s          ",
        "\r  |++++++++++++++++++++++++++++                      | 56% ~08s          \r  |+++++++++++++++++++++++++++++                     | 57% ~08s          \r  |+++++++++++++++++++++++++++++                     | 58% ~08s          \r  |++++++++++++++++++++++++++++++                    | 59% ~08s          \r  |++++++++++++++++++++++++++++++                    | 60% ~08s          \r  |+++++++++++++++++++++++++++++++                   | 61% ~08s          \r  |+++++++++++++++++++++++++++++++                   | 62% ~07s          ",
        "\r  |++++++++++++++++++++++++++++++++                  | 63% ~07s          \r  |++++++++++++++++++++++++++++++++                  | 64% ~07s          \r  |+++++++++++++++++++++++++++++++++                 | 65% ~07s          \r  |+++++++++++++++++++++++++++++++++                 | 66% ~07s          \r  |++++++++++++++++++++++++++++++++++                | 67% ~06s          \r  |++++++++++++++++++++++++++++++++++                | 68% ~06s          \r  |+++++++++++++++++++++++++++++++++++               | 69% ~06s          ",
        "\r  |+++++++++++++++++++++++++++++++++++               | 70% ~06s          \r  |++++++++++++++++++++++++++++++++++++              | 71% ~06s          \r  |++++++++++++++++++++++++++++++++++++              | 72% ~05s          \r  |+++++++++++++++++++++++++++++++++++++             | 73% ~05s          \r  |+++++++++++++++++++++++++++++++++++++             | 74% ~05s          \r  |++++++++++++++++++++++++++++++++++++++            | 75% ~05s          \r  |++++++++++++++++++++++++++++++++++++++            | 76% ~05s          ",
        "\r  |+++++++++++++++++++++++++++++++++++++++           | 77% ~04s          \r  |+++++++++++++++++++++++++++++++++++++++           | 78% ~04s          \r  |++++++++++++++++++++++++++++++++++++++++          | 79% ~04s          \r  |++++++++++++++++++++++++++++++++++++++++          | 80% ~04s          \r  |+++++++++++++++++++++++++++++++++++++++++         | 81% ~04s          \r  |+++++++++++++++++++++++++++++++++++++++++         | 82% ~04s          \r  |++++++++++++++++++++++++++++++++++++++++++        | 83% ~03s          ",
        "\r  |++++++++++++++++++++++++++++++++++++++++++        | 84% ~03s          \r  |+++++++++++++++++++++++++++++++++++++++++++       | 85% ~03s          \r  |+++++++++++++++++++++++++++++++++++++++++++       | 86% ~03s          \r  |++++++++++++++++++++++++++++++++++++++++++++      | 87% ~03s          \r  |++++++++++++++++++++++++++++++++++++++++++++      | 88% ~02s          \r  |+++++++++++++++++++++++++++++++++++++++++++++     | 89% ~02s          \r  |+++++++++++++++++++++++++++++++++++++++++++++     | 90% ~02s          ",
        "\r  |++++++++++++++++++++++++++++++++++++++++++++++    | 91% ~02s          \r  |++++++++++++++++++++++++++++++++++++++++++++++    | 92% ~02s          \r  |+++++++++++++++++++++++++++++++++++++++++++++++   | 93% ~01s          \r  |+++++++++++++++++++++++++++++++++++++++++++++++   | 94% ~01s          \r  |++++++++++++++++++++++++++++++++++++++++++++++++  | 95% ~01s          \r  |++++++++++++++++++++++++++++++++++++++++++++++++  | 96% ~01s          \r  |+++++++++++++++++++++++++++++++++++++++++++++++++ | 97% ~01s          ",
        "\r  |+++++++++++++++++++++++++++++++++++++++++++++++++ | 98% ~00s          \r  |++++++++++++++++++++++++++++++++++++++++++++++++++| 99% ~00s          \r  |++++++++++++++++++++++++++++++++++++++++++++++++++| 100% elapsed=19s  \n",
        "Error in c.stars(sosC, eosC, along = \"dates\") : \n  convert stars_proxy objects to stars first using st_as_stars()\n",
        "Además: ",
        "There were 50 or more warnings (use warnings() to see the first 50)",
        "\n",
        "> ",
        "",
        "> ",
        "stopCluster(cl)",
        "> ",
        "i <- 1",
        "> ",
        "sliceY",
        "  [1]  3580  3680  3780  3880  3980  4080  4180  4280  4380  4480  4580  4680  4780  4880  4980  5080  5180\n [18]  5280  5380  5480  5580  5680  5780  5880  5980  6080  6180  6280  6380  6480  6580  6680  6780  6880\n [35]  6980  7080  7180  7280  7380  7480  7580  7680  7780  7880  7980  8080  8180  8280  8380  8480  8580\n [52]  8680  8780  8880  8980  9080  9180  9280  9380  9480  9580  9680  9780  9880  9980 10080 10180 10280\n [69] 10380 10480 10580 10680 10780 10880 10980 11080 11180 11280 11380 11480 11580",
        " 11680 11780 11880 11980\n [86] 12080 12180 12280 12380 12480 12580 12680 12780 12880 12980 13080 13180 13280 13380 13480 13580 13680\n[103] 13780 13880 13980 14080 14180 14280 14380 14480 14580 14680 14780 14880 14980 15080 15180 15280 15380\n[120] 15480 15580 15680 15780 15880 15980 16080 16180 16280 16380 16480 16580 16680 16780 16880 16980 17080\n[137] 17180 17280 17380 17480 17580 17680 17780 17880 17980 18080 18180 18280 18380 18480 18580 18680 18780\n[154] 18880 18980 19080 19180 19280 19380 19480 19580 19680",
        " 19780 19880 19980 20080 20180 20280 20380 20480\n[171] 20580 20680 20780 20880 20980 21080 21180 21280 21380 21480 21580 21680 21780 21880 21980\n",
        "> ",
        "rasterio <- list(nXOff = 6088, nYOff = sliceY[i]+1, nXSize = 3081, nYSize = ysize)",
        "> ",
        "  ",
        "> ",
        "  ndvi <- read_stars(lf, along ='dates',RasterIO = rasterio)",
        "> ",
        "  sosC <- st_as_stars(st_crop(sos,ndvi))",
        "> ",
        "  eosC <- st_as_stars(st_crop(eos,ndvi))",
        "> ",
        "  ",
        "> ",
        "  dates <- as.Date(substr(lf,67,74),\"%Y%j\")",
        "> ",
        "  ",
        "> ",
        "  message('Suavizado NDVI...')",
        "Suavizado NDVI...\n",
        "> ",
        "  NDVI_smooth <- st_apply(ndvi,1:2,smoothNDVI,n=5,CLUSTER = cl,PROGRESS = TRUE,.fname = 'dates')",
        "> ",
        "  NDVI_smooth <- st_as_stars(NDVI_smooth) ",
        "\r  |                                                  | 0 % ~calculating  ",
        "Error in summary.connection(connection) : conexión inválida\n",
        "Además: ",
        "There were 50 or more warnings (use warnings() to see the first 50)",
        "\n",
        "\n",
        "> ",
        "  NDVI_smooth <- merge(split(NDVI_smooth,'dates'),name='dates')",
        "> ",
        "  ",
        "> ",
        "  ",
        "> ",
        "  esNDVI <- c(c(sosC,eosC,along = 'dates'),NDVI_smooth, along = 'dates')",
        "Error in combine_dimensions(dots, along_dim) : \n  dimensions of element 1 and 2 are not identical\n",
        "> ",
        "  ",
        "> ",
        "  rm(NDVI_smooth)",
        "> ",
        "  gc()",
        "            used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells   1745998   93.3    4645030   248.1    4645030   248.1\nVcells 394046998 3006.4 1360993954 10383.6 1655277081 12628.8\n",
        "> ",
        "  ",
        "> ",
        "  message('Acmulado NDVI..')",
        "Acmulado NDVI..\n",
        "> ",
        "  eoscNDVI <- st_apply(esNDVI,1:2,cumRast,dates = dates, step = 16,get = 'eos',CLUSTER = cl,PROGRESS = TRUE,.fname = 'dates')",
        "Error in st_apply(esNDVI, 1:2, cumRast, dates = dates, step = 16, get = \"eos\",  : \n  objeto 'esNDVI' no encontrado\n",
        "> ",
        "  eoscNDVI <- merge(split(eoscNDVI,'dates'),name='dates')",
        "Error in h(simpleError(msg, call)) : \n  error in evaluating the argument 'x' in selecting a method for function 'merge': error in evaluating the argument 'x' in selecting a method for function 'split': objeto 'eoscNDVI' no encontrado\n",
        "> ",
        "  ",
        "> ",
        "  rm(esNDVI)",
        "Warning message:\n",
        "In rm(esNDVI) :",
        " objeto 'esNDVI' no encontrado\n",
        "> ",
        "  gc()",
        "            used   (Mb) gc trigger   (Mb)   max used    (Mb)\nNcells   1746042   93.3    4645030  248.1    4645030   248.1\nVcells 394046918 3006.4 1088795164 8306.9 1655277081 12628.8\n\nRestarting R session...\n\n",
        "> ",
        "product <- 'NDVI.MOD13Q1.006/'",
        "> ",
        "",
        "> ",
        "dir <- paste0('/mnt/HDD4TB_2/data/rasters/Procesados/MODIS/',product)",
        "> ",
        "dir.ph <- '/mnt/HDD4TB_2/data/rasters/Procesados/MODIS/Phenology/'",
        "> ",
        "",
        "> ",
        "library(stars)",
        "Loading required package: abind\n",
        "Loading required package: sf\n",
        "Linking to GEOS 3.9.0, GDAL 3.2.2, PROJ 7.2.1; sf_use_s2() is TRUE\n",
        "> ",
        "library(terra)",
        "terra 1.5.21\n",
        "> ",
        "library(sf)",
        "> ",
        "library(snow)",
        "> ",
        "",
        "> ",
        "pol <- st_read('data/spatial/chile_continental.gpkg')",
        "Reading layer `chile_continental' from data source \n  `/mnt/0FA1FA650427517A/OneDrive/R-projects/drought-vegetation/data/spatial/chile_continental.gpkg' \n  using driver `GPKG'\nSimple feature collection with 1 feature and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -75.68856 ymin: -55.97945 xmax: -66.41828 ymax: -17.49849\nGeodetic CRS:  WGS 84\n",
        "> ",
        "pol <- st_transform(pol,32719)",
        "> ",
        "lf <- list.files(dir,pattern='*.tif$', full.names=TRUE)",
        "> ",
        "#",
        "> ",
        "ysize = 100",
        "> ",
        "sliceY <- seq(3580,22015,ysize)",
        "> ",
        "",
        "> ",
        "source('R/functions/cumRast.R')",
        "> ",
        "source('R/functions/getPerPixel.R')",
        "> ",
        "source('R/functions/smoothNDVI.R')",
        "> ",
        "",
        "> ",
        "sos <- st_as_stars(disagg(rast(file.path(dir.ph,'SOS.Chile.S1.500m.tif')),2))",
        "> ",
        "eos <- st_as_stars(disagg(rast(file.path(dir.ph,'EOS.Chile.S1.500m.tif')),2))",
        "> ",
        "",
        "> ",
        "cl <- makeCluster(11,\"SOCK\")",
        "> ",
        "i <- 1",
        "> ",
        "rasterio <- list(nXOff = 6088, nYOff = sliceY[i]+1, nXSize = 3081, nYSize = ysize)",
        "> ",
        "  ",
        "> ",
        "  ndvi <- read_stars(lf, along ='dates',RasterIO = rasterio)",
        "> ",
        "  sosC <- st_as_stars(st_crop(sos,ndvi))",
        "> ",
        "  eosC <- st_as_stars(st_crop(eos,ndvi))",
        "> ",
        "  ",
        "> ",
        "  dates <- as.Date(substr(lf,67,74),\"%Y%j\")",
        "> ",
        "  ",
        "> ",
        "  message('Suavizado NDVI...')",
        "Suavizado NDVI...\n",
        "> ",
        "  NDVI_smooth <- st_apply(ndvi,1:2,smoothNDVI,n=5,CLUSTER = cl,PROGRESS = TRUE,.fname = 'dates')",
        "> ",
        "  NDVI_smooth <- st_as_stars(NDVI_smooth) ",
        "\r  |                                                  | 0 % ~calculating  \r  |+                                                 | 1 % ~20s          \r  |+                                                 | 2 % ~17s          \r  |++                                                | 3 % ~16s          \r  |++                                                | 4 % ~16s          \r  |+++                                               | 5 % ~16s          \r  |+++                                               | 6 % ~16s          ",
        "\r  |++++                                              | 7 % ~16s          \r  |++++                                              | 8 % ~15s          \r  |+++++                                             | 9 % ~16s          \r  |+++++                                             | 10% ~16s          \r  |++++++                                            | 11% ~15s          \r  |++++++                                            | 12% ~15s          \r  |+++++++                                           | 13% ~15s          ",
        "\r  |+++++++                                           | 14% ~15s          \r  |++++++++                                          | 15% ~15s          \r  |++++++++                                          | 16% ~15s          \r  |+++++++++                                         | 17% ~15s          \r  |+++++++++                                         | 18% ~15s          \r  |++++++++++                                        | 19% ~15s          \r  |++++++++++                                        | 20% ~15s          ",
        "\r  |+++++++++++                                       | 21% ~14s          \r  |+++++++++++                                       | 22% ~14s          \r  |++++++++++++                                      | 23% ~14s          \r  |++++++++++++                                      | 24% ~14s          \r  |+++++++++++++                                     | 25% ~14s          \r  |+++++++++++++                                     | 26% ~14s          \r  |++++++++++++++                                    | 27% ~13s          ",
        "\r  |++++++++++++++                                    | 28% ~13s          \r  |+++++++++++++++                                   | 29% ~13s          \r  |+++++++++++++++                                   | 30% ~13s          \r  |++++++++++++++++                                  | 31% ~13s          \r  |++++++++++++++++                                  | 32% ~13s          \r  |+++++++++++++++++                                 | 33% ~12s          \r  |+++++++++++++++++                                 | 34% ~12s          ",
        "\r  |++++++++++++++++++                                | 35% ~12s          \r  |++++++++++++++++++                                | 36% ~12s          \r  |+++++++++++++++++++                               | 37% ~12s          \r  |+++++++++++++++++++                               | 38% ~12s          \r  |++++++++++++++++++++                              | 39% ~11s          \r  |++++++++++++++++++++                              | 40% ~11s          \r  |+++++++++++++++++++++                             | 41% ~11s          ",
        "\r  |+++++++++++++++++++++                             | 42% ~11s          \r  |++++++++++++++++++++++                            | 43% ~11s          \r  |++++++++++++++++++++++                            | 44% ~11s          \r  |+++++++++++++++++++++++                           | 45% ~10s          \r  |+++++++++++++++++++++++                           | 46% ~10s          \r  |++++++++++++++++++++++++                          | 47% ~10s          \r  |++++++++++++++++++++++++                          | 48% ~10s          ",
        "\r  |+++++++++++++++++++++++++                         | 49% ~10s          \r  |+++++++++++++++++++++++++                         | 50% ~10s          \r  |++++++++++++++++++++++++++                        | 51% ~09s          \r  |++++++++++++++++++++++++++                        | 52% ~09s          \r  |+++++++++++++++++++++++++++                       | 53% ~09s          \r  |+++++++++++++++++++++++++++                       | 54% ~09s          \r  |++++++++++++++++++++++++++++                      | 55% ~09s          ",
        "\r  |++++++++++++++++++++++++++++                      | 56% ~08s          \r  |+++++++++++++++++++++++++++++                     | 57% ~08s          \r  |+++++++++++++++++++++++++++++                     | 58% ~08s          \r  |++++++++++++++++++++++++++++++                    | 59% ~08s          \r  |++++++++++++++++++++++++++++++                    | 60% ~08s          \r  |+++++++++++++++++++++++++++++++                   | 61% ~07s          \r  |+++++++++++++++++++++++++++++++                   | 62% ~07s          ",
        "\r  |++++++++++++++++++++++++++++++++                  | 63% ~07s          \r  |++++++++++++++++++++++++++++++++                  | 64% ~07s          \r  |+++++++++++++++++++++++++++++++++                 | 65% ~07s          \r  |+++++++++++++++++++++++++++++++++                 | 66% ~07s          \r  |++++++++++++++++++++++++++++++++++                | 67% ~06s          \r  |++++++++++++++++++++++++++++++++++                | 68% ~06s          \r  |+++++++++++++++++++++++++++++++++++               | 69% ~06s          ",
        "\r  |+++++++++++++++++++++++++++++++++++               | 70% ~06s          \r  |++++++++++++++++++++++++++++++++++++              | 71% ~06s          \r  |++++++++++++++++++++++++++++++++++++              | 72% ~05s          \r  |+++++++++++++++++++++++++++++++++++++             | 73% ~05s          \r  |+++++++++++++++++++++++++++++++++++++             | 74% ~05s          \r  |++++++++++++++++++++++++++++++++++++++            | 75% ~05s          \r  |++++++++++++++++++++++++++++++++++++++            | 76% ~05s          ",
        "\r  |+++++++++++++++++++++++++++++++++++++++           | 77% ~04s          \r  |+++++++++++++++++++++++++++++++++++++++           | 78% ~04s          \r  |++++++++++++++++++++++++++++++++++++++++          | 79% ~04s          \r  |++++++++++++++++++++++++++++++++++++++++          | 80% ~04s          \r  |+++++++++++++++++++++++++++++++++++++++++         | 81% ~04s          \r  |+++++++++++++++++++++++++++++++++++++++++         | 82% ~04s          \r  |++++++++++++++++++++++++++++++++++++++++++        | 83% ~03s          ",
        "\r  |++++++++++++++++++++++++++++++++++++++++++        | 84% ~03s          \r  |+++++++++++++++++++++++++++++++++++++++++++       | 85% ~03s          \r  |+++++++++++++++++++++++++++++++++++++++++++       | 86% ~03s          \r  |++++++++++++++++++++++++++++++++++++++++++++      | 87% ~03s          \r  |++++++++++++++++++++++++++++++++++++++++++++      | 88% ~02s          \r  |+++++++++++++++++++++++++++++++++++++++++++++     | 89% ~02s          \r  |+++++++++++++++++++++++++++++++++++++++++++++     | 90% ~02s          ",
        "\r  |++++++++++++++++++++++++++++++++++++++++++++++    | 91% ~02s          \r  |++++++++++++++++++++++++++++++++++++++++++++++    | 92% ~02s          \r  |+++++++++++++++++++++++++++++++++++++++++++++++   | 93% ~01s          \r  |+++++++++++++++++++++++++++++++++++++++++++++++   | 94% ~01s          \r  |++++++++++++++++++++++++++++++++++++++++++++++++  | 95% ~01s          \r  |++++++++++++++++++++++++++++++++++++++++++++++++  | 96% ~01s          \r  |+++++++++++++++++++++++++++++++++++++++++++++++++ | 97% ~01s          ",
        "\r  |+++++++++++++++++++++++++++++++++++++++++++++++++ | 98% ~00s          \r  |++++++++++++++++++++++++++++++++++++++++++++++++++| 99% ~00s          \r  |++++++++++++++++++++++++++++++++++++++++++++++++++| 100% elapsed=19s  \n",
        "There were 50 or more warnings (use warnings() to see the first 50)",
        "\n",
        "> ",
        "  NDVI_smooth <- merge(split(NDVI_smooth,'dates'),name='dates')",
        "> ",
        "  ",
        "> ",
        "  ",
        "> ",
        "  esNDVI <- c(c(sosC,eosC,along = 'dates'),NDVI_smooth, along = 'dates')",
        "Error in combine_dimensions(dots, along_dim) : \n  dimensions of element 1 and 2 are not identical\n",
        "> ",
        "  ",
        "> ",
        "  rm(NDVI_smooth)",
        "> ",
        "  gc()",
        "            used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells   1431418   76.5    4477951   239.2    4477951   239.2\nVcells 392761145 2996.6 1360312402 10378.4 1336675234 10198.1\n",
        "> ",
        "  message('Acmulado NDVI..')",
        "Acmulado NDVI..\n",
        "> ",
        "  eoscNDVI <- st_apply(esNDVI,1:2,cumRast,dates = dates, step = 16,get = 'eos',CLUSTER = cl,PROGRESS = TRUE,.fname = 'dates')",
        "Error in st_apply(esNDVI, 1:2, cumRast, dates = dates, step = 16, get = \"eos\",  : \n  objeto 'esNDVI' no encontrado\n",
        "> ",
        "c(sosC,eosC,along = 'dates')",
        "Error in combine_dimensions(dots, along_dim) : \n  dimensions of element 1 and 2 are not identical\n",
        "> ",
        "sosC",
        "stars object with 2 dimensions and 1 attribute\nattribute(s):\n         Min. 1st Qu. Median     Mean 3rd Qu.  Max.   NA's\nvalues  11925   12034  12044 12043.25   12053 12378 273896\ndimension(s):\n  from   to   offset    delta                refsys point values x/y\nx 6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S    NA   NULL [x]\ny 3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S    NA   NULL [y]\n",
        "> ",
        "eosC",
        "stars object with 2 dimensions and 1 attribute\nattribute(s):\n                                    Min. 1st Qu. Median     Mean 3rd Qu.  Max.   NA's\nspat_cVW44YJDVG9hCY3_240442.ti...  12077   12173  12187 12189.36 12201.5 12562 273896\ndimension(s):\n  from   to   offset    delta                refsys point values x/y\nx 6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S FALSE   NULL [x]\ny 3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S FALSE   NULL [y]\n",
        "> ",
        "c(sosC,eosC)",
        "Error in c.stars(sosC, eosC) : \n  don't know how to merge arrays: please specify parameter along\n",
        "> ",
        "c(sosC,eosC,along='dates')",
        "Error in combine_dimensions(dots, along_dim) : \n  dimensions of element 1 and 2 are not identical\n",
        "> ",
        "sosC",
        "stars object with 2 dimensions and 1 attribute\nattribute(s):\n         Min. 1st Qu. Median     Mean 3rd Qu.  Max.   NA's\nvalues  11925   12034  12044 12043.25   12053 12378 273896\ndimension(s):\n  from   to   offset    delta                refsys point values x/y\nx 6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S    NA   NULL [x]\ny 3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S    NA   NULL [y]\n",
        "> ",
        "st_dimensions(sosC)",
        "  from   to   offset    delta                refsys point values x/y\nx 6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S    NA   NULL [x]\ny 3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S    NA   NULL [y]\n",
        "> ",
        "st_dimensions(eosC)",
        "  from   to   offset    delta                refsys point values x/y\nx 6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S FALSE   NULL [x]\ny 3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S FALSE   NULL [y]\n",
        "> ",
        "sos$values",
        "            [,1]    [,2]    [,3]    [,4]    [,5]    [,6]    [,7]    [,8]    [,9]   [,10]   [,11]   [,12]\n           [,13]   [,14]   [,15]   [,16]   [,17]   [,18]   [,19]   [,20]   [,21]   [,22]   [,23]   [,24]\n           [,25]   [,26]   [,27]   [,28]   [,29]   [,30]   [,31]   [,32]   [,33]   [,34]   [,35]   [,36]\n           [,37]   [,38]   [,39]   [,40]   [,41]   [,42]   [,43]   [,44]   [,45]   [,46]   [,47]   [,48]\n           [,49]   [,50]   [,51]   [,52]   [,53]   [,54]   [,55]   [,56]   [,57]   [,58]   [,59]",
        "   [,60]\n           [,61]   [,62]   [,63]   [,64]   [,65]   [,66]   [,67]   [,68]   [,69]   [,70]   [,71]   [,72]\n           [,73]   [,74]   [,75]   [,76]   [,77]   [,78]   [,79]   [,80]",
        "> ",
        "> ",
        "sosC",
        "stars object with 2 dimensions and 1 attribute\nattribute(s):\n         Min. 1st Qu. Median     Mean 3rd Qu.  Max.   NA's\nvalues  11925   12034  12044 12043.25   12053 12378 273896\ndimension(s):\n  from   to   offset    delta                refsys point values x/y\nx 6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S    NA   NULL [x]\ny 3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S    NA   NULL [y]\n",
        "> ",
        "eosC",
        "stars object with 2 dimensions and 1 attribute\nattribute(s):\n                                    Min. 1st Qu. Median     Mean 3rd Qu.  Max.   NA's\nspat_cVW44YJDVG9hCY3_240442.ti...  12077   12173  12187 12189.36 12201.5 12562 273896\ndimension(s):\n  from   to   offset    delta                refsys point values x/y\nx 6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S FALSE   NULL [x]\ny 3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S FALSE   NULL [y]\n",
        "> ",
        "  sosC <- st_as_stars(st_crop(sos,ndvi))",
        "> ",
        "  eosC <- st_as_stars(st_crop(eos,ndvi))",
        "> ",
        "sosC",
        "stars object with 2 dimensions and 1 attribute\nattribute(s):\n         Min. 1st Qu. Median     Mean 3rd Qu.  Max.   NA's\nvalues  11925   12034  12044 12043.25   12053 12378 273896\ndimension(s):\n  from   to   offset    delta                refsys point values x/y\nx 6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S    NA   NULL [x]\ny 3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S    NA   NULL [y]\n",
        "> ",
        "eosC",
        "stars object with 2 dimensions and 1 attribute\nattribute(s):\n                                    Min. 1st Qu. Median     Mean 3rd Qu.  Max.   NA's\nspat_cVW44YJDVG9hCY3_240442.ti...  12077   12173  12187 12189.36 12201.5 12562 273896\ndimension(s):\n  from   to   offset    delta                refsys point values x/y\nx 6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S FALSE   NULL [x]\ny 3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S FALSE   NULL [y]\n",
        "> ",
        "names(eosC)",
        "[1] \"spat_cVW44YJDVG9hCY3_240442.tif\"\n",
        "> ",
        "names(sosC)",
        "[1] \"values\"\n",
        "> ",
        "names(eosC)",
        "[1] \"spat_cVW44YJDVG9hCY3_240442.tif\"\n",
        "> ",
        "names(eosC) <- 'values'",
        "> ",
        "  esNDVI <- c(c(sosC,eosC,along = 'dates'),NDVI_smooth, along = 'dates')",
        "Error in combine_dimensions(dots, along_dim) : \n  dimensions of element 1 and 2 are not identical\n",
        "> ",
        "sosC",
        "stars object with 2 dimensions and 1 attribute\nattribute(s):\n         Min. 1st Qu. Median     Mean 3rd Qu.  Max.   NA's\nvalues  11925   12034  12044 12043.25   12053 12378 273896\ndimension(s):\n  from   to   offset    delta                refsys point values x/y\nx 6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S    NA   NULL [x]\ny 3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S    NA   NULL [y]\n",
        "> ",
        "epsC",
        "Error: objeto 'epsC' no encontrado\n",
        "> ",
        "eosC",
        "stars object with 2 dimensions and 1 attribute\nattribute(s):\n         Min. 1st Qu. Median     Mean 3rd Qu.  Max.   NA's\nvalues  12077   12173  12187 12189.36 12201.5 12562 273896\ndimension(s):\n  from   to   offset    delta                refsys point values x/y\nx 6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S FALSE   NULL [x]\ny 3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S FALSE   NULL [y]\n",
        "> ",
        "c(sosC,eosC,along = 'dates')",
        "Error in combine_dimensions(dots, along_dim) : \n  dimensions of element 1 and 2 are not identical\n",
        "> ",
        "combine_dimensions",
        "Error: objeto 'combine_dimensions' no encontrado\n",
        "> ",
        "c(sosC,ndvi,along = 'dates')",
        "Error in c.stars(sosC, ndvi, along = \"dates\") : \n  convert stars_proxy objects to stars first using st_as_stars()\n",
        "> ",
        "ndvi",
        "stars_proxy object with 1 attribute in 510 file(s); showing the first 10 filenames\n$attr\n [1] \"[...]/chl_2000049_250m_16_days_NDVI.tif\" \"[...]/chl_2000065_250m_16_days_NDVI.tif\"\n [3] \"[...]/chl_2000081_250m_16_days_NDVI.tif\" \"[...]/chl_2000097_250m_16_days_NDVI.tif\"\n [5] \"[...]/chl_2000113_250m_16_days_NDVI.tif\" \"[...]/chl_2000129_250m_16_days_NDVI.tif\"\n [7] \"[...]/chl_2000145_250m_16_days_NDVI.tif\" \"[...]/chl_2000161_250m_16_days_NDVI.tif\"\n [9] \"[...]/chl_2000177_250m_16_days_NDVI.tif\" \"[...]/chl_2000193_250m_16_days_NDVI.tif\"",
        "\n\ndimension(s):\n      from   to   offset    delta                refsys point values x/y\nx     6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S FALSE   NULL [x]\ny     3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S FALSE   NULL [y]\ndates    1  510       NA       NA                    NA    NA   NULL    \n",
        "> ",
        "  ndvi <- read_stars(lf, along ='dates',RasterIO = rasterio)",
        "> ",
        "ndvi",
        "stars_proxy object with 1 attribute in 510 file(s); showing the first 10 filenames\n$attr\n [1] \"[...]/chl_2000049_250m_16_days_NDVI.tif\" \"[...]/chl_2000065_250m_16_days_NDVI.tif\"\n [3] \"[...]/chl_2000081_250m_16_days_NDVI.tif\" \"[...]/chl_2000097_250m_16_days_NDVI.tif\"\n [5] \"[...]/chl_2000113_250m_16_days_NDVI.tif\" \"[...]/chl_2000129_250m_16_days_NDVI.tif\"\n [7] \"[...]/chl_2000145_250m_16_days_NDVI.tif\" \"[...]/chl_2000161_250m_16_days_NDVI.tif\"\n [9] \"[...]/chl_2000177_250m_16_days_NDVI.tif\" \"[...]/chl_2000193_250m_16_days_NDVI.tif\"",
        "\n\ndimension(s):\n      from   to   offset    delta                refsys point values x/y\nx     6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S FALSE   NULL [x]\ny     3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S FALSE   NULL [y]\ndates    1  510       NA       NA                    NA    NA   NULL    \n",
        "> ",
        "  ndvi <- st_as_stars(ndvi)",
        "There were 50 or more warnings (use warnings() to see the first 50)",
        "\n",
        "> ",
        "  sosC <- st_crop(sos,ndvi)",
        "> ",
        "  eosC <- st_crop(eos,ndvi)",
        "> ",
        "sosC",
        "stars object with 2 dimensions and 1 attribute\nattribute(s):\n         Min. 1st Qu. Median     Mean 3rd Qu.  Max.   NA's\nvalues  11925   12034  12044 12043.25   12053 12378 273896\ndimension(s):\n  from   to   offset    delta                refsys point values x/y\nx 6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S    NA   NULL [x]\ny 3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S    NA   NULL [y]\n",
        "> ",
        "eosC",
        "stars_proxy object with 1 attribute in 1 file(s):\n$spat_cVW44YJDVG9hCY3_240442.tif\n[1] \"[...]/spat_cVW44YJDVG9hCY3_240442.tif\"\n\ndimension(s):\n  from   to   offset    delta                refsys point values x/y\nx 6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S FALSE   NULL [x]\ny 3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S FALSE   NULL [y]\ncall_list:\n[[1]]\nst_crop(x = x, y = y, crop = crop, epsilon = epsilon)\nattr(,\".Environment\")\n<environment: 0x5564971d2de0>\n\n",
        "> ",
        "  eosC <- st_as_stars(st_crop(eos,ndvi))",
        "> ",
        "c(sosC,eosC,along = 'dates')",
        "Error in combine_dimensions(dots, along_dim) : \n  dimensions of element 1 and 2 are not identical\n",
        "> ",
        "sosC",
        "stars object with 2 dimensions and 1 attribute\nattribute(s):\n         Min. 1st Qu. Median     Mean 3rd Qu.  Max.   NA's\nvalues  11925   12034  12044 12043.25   12053 12378 273896\ndimension(s):\n  from   to   offset    delta                refsys point values x/y\nx 6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S    NA   NULL [x]\ny 3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S    NA   NULL [y]\n",
        "> ",
        "eosC",
        "stars object with 2 dimensions and 1 attribute\nattribute(s):\n                                    Min. 1st Qu. Median     Mean 3rd Qu.  Max.   NA's\nspat_cVW44YJDVG9hCY3_240442.ti...  12077   12173  12187 12189.36 12201.5 12562 273896\ndimension(s):\n  from   to   offset    delta                refsys point values x/y\nx 6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S FALSE   NULL [x]\ny 3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S FALSE   NULL [y]\n",
        "> ",
        "?st_combine()",
        "> ",
        "> ",
        "sos <- disagg(rast(file.path(dir.ph,'SOS.Chile.S1.500m.tif')),2)",
        "> ",
        "eos <- disagg(rast(file.path(dir.ph,'EOS.Chile.S1.500m.tif')),2)",
        "Error in x$.self$finalize() : tentativa de aplicar una no-función\n",
        "Error in x$.self$finalize() : tentativa de aplicar una no-función\n",
        "Error in x$.self$finalize() : tentativa de aplicar una no-función\n",
        "Error in x$.self$finalize() : tentativa de aplicar una no-función\n",
        "> ",
        "rast(c(sos,eos))",
        "class       : SpatRaster \ndimensions  : 25708, 15152, 2  (nrow, ncol, nlyr)\nresolution  : 231.6564, 231.6564  (x, y)\nextent      : -1417787, 2092271, 2939166, 8894587  (xmin, xmax, ymin, ymax)\ncoord. ref. : WGS 84 / UTM zone 19S (EPSG:32719) \n",
        "> ",
        "  sos_eosC <- st_as_stars(st_crop(st_as_stars(rast(c(sos,eos))),ndvi))",
        "Warning message:\n",
        "[readValues] raster has no values\n \n",
        "> ",
        "sos_eosC",
        "stars object with 3 dimensions and 1 attribute\nattribute(s):\n        Min. 1st Qu. Median Mean 3rd Qu. Max.   NA's\nvalues    NA      NA     NA  NaN      NA   NA 616200\ndimension(s):\n     from   to   offset    delta                refsys point                               values x/y\nx    6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S    NA                                 NULL [x]\ny    3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S    NA                                 NULL [y]\nband    1    2       NA       NA",
        "                    NA    NA SOS.Chile.S1.500m, EOS.Chile.S1.500m    \n",
        "> ",
        "plot(sos_eosC)",
        "Error in image.default(dims[[dimx]], dims[[dimy]], ar, asp = asp, xlab = xlab,  : \n  'breaks' must all be finite\n",
        "Además: ",
        "Warning messages:\n",
        "1: ",
        "In min(x) :",
        " ningún argumento finito para min; retornando Inf\n",
        "2: ",
        "In max(x) :",
        " ningun argumento finito para max; retornando -Inf\n",
        "3: ",
        "In plot.stars(sos_eosC) :",
        "\n ",
        " breaks=\"quantile\" leads to a single class; maybe try breaks=\"equal\" instead?\n",
        "4: ",
        "In min(x) :",
        " ningún argumento finito para min; retornando Inf\n",
        "5: ",
        "In max(x) :",
        " ningun argumento finito para max; retornando -Inf\n",
        "> ",
        "st_as_stars(rast(c(sos,eos)))",
        "stars object with 3 dimensions and 1 attribute\nattribute(s), summary of first 1e+05 cells:\n        Min. 1st Qu. Median Mean 3rd Qu. Max.  NA's\nvalues    NA      NA     NA  NaN      NA   NA 1e+05\ndimension(s):\n     from    to   offset    delta                refsys point                               values x/y\nx       1 15152 -1417787  231.656 WGS 84 / UTM zone 19S    NA                                 NULL [x]\ny       1 25708  8894587 -231.656 WGS 84 / UTM zone 19S    NA                                 NULL",
        " [y]\nband    1     2       NA       NA                    NA    NA SOS.Chile.S1.500m, EOS.Chile.S1.500m    \n",
        "Warning message:\n",
        "[readValues] raster has no values\n \n",
        "> ",
        "plot(sos)",
        "> ",
        "sos_eos <- rast(c(sos,eos))",
        "> ",
        "plot(sos_eos)",
        "Warning messages:\n",
        "1: [plot] SpatRaster has no cell values \n",
        "2: [plot] SpatRaster has no cell values \n",
        "> ",
        "plot(sos)",
        "> ",
        "sos_eos",
        "class       : SpatRaster \ndimensions  : 25708, 15152, 2  (nrow, ncol, nlyr)\nresolution  : 231.6564, 231.6564  (x, y)\nextent      : -1417787, 2092271, 2939166, 8894587  (xmin, xmax, ymin, ymax)\ncoord. ref. : WGS 84 / UTM zone 19S (EPSG:32719) \n",
        "> ",
        "sos",
        "class       : SpatRaster \ndimensions  : 25708, 15152, 1  (nrow, ncol, nlyr)\nresolution  : 231.6564, 231.6564  (x, y)\nextent      : -1417787, 2092271, 2939166, 8894587  (xmin, xmax, ymin, ymax)\ncoord. ref. : WGS 84 / UTM zone 19S (EPSG:32719) \nsource      : memory \nname        : SOS.Chile.S1.500m \nmin value   :             11872 \nmax value   :             12407 \n",
        "> ",
        "?`add<-`()",
        "Error in .helpForCall(topicExpr, parent.frame()) : \n  no documentation for function ‘add<-’ and signature ‘x = \"missing\", value = \"missing\"’\n",
        "Además: ",
        "Warning message:\n",
        "In .helpForCall(topicExpr, parent.frame()) :",
        "\n ",
        " no method defined for function ‘add<-’ and signature ‘x = \"missing\", value = \"missing\"’\n",
        "> ",
        "c(sos,eos)",
        "class       : SpatRaster \ndimensions  : 25708, 15152, 2  (nrow, ncol, nlyr)\nresolution  : 231.6564, 231.6564  (x, y)\nextent      : -1417787, 2092271, 2939166, 8894587  (xmin, xmax, ymin, ymax)\ncoord. ref. : WGS 84 / UTM zone 19S (EPSG:32719) \nsources     : memory  \n              spat_qNi8063UVAzJgDT_240442.tif  \nnames       : SOS.Chile.S1.500m, EOS.Chile.S1.500m \nmin values  :             11872,             12060 \nmax values  :             12407,             12599 \n",
        "> ",
        "sos_eos <- c(sos,eos)",
        "> ",
        "plot(sos_eos)",
        "> ",
        "sos_eos <- c(sos,eos)",
        "> ",
        "  sos_eosC <- st_as_stars(st_crop(st_as_stars(sos_eos),ndvi))",
        "> ",
        "sos_eosC",
        "stars object with 3 dimensions and 1 attribute\nattribute(s):\n         Min. 1st Qu. Median     Mean 3rd Qu.  Max.   NA's\nvalues  11925   12044  12135 12116.31   12187 12562 547792\ndimension(s):\n     from   to   offset    delta                refsys point                               values x/y\nx    6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S    NA                                 NULL [x]\ny    3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S    NA                                 NULL [y]\nband    1    2",
        "       NA       NA                    NA    NA SOS.Chile.S1.500m, EOS.Chile.S1.500m    \n",
        "> ",
        "  sos_eosC <- st_as_stars(st_crop(st_as_stars(sos_eos),ndvi),along = 'dates')",
        "> ",
        "sos_eosC",
        "stars object with 3 dimensions and 1 attribute\nattribute(s):\n         Min. 1st Qu. Median     Mean 3rd Qu.  Max.   NA's\nvalues  11925   12044  12135 12116.31   12187 12562 547792\ndimension(s):\n     from   to   offset    delta                refsys point                               values x/y\nx    6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S    NA                                 NULL [x]\ny    3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S    NA                                 NULL [y]\nband    1    2",
        "       NA       NA                    NA    NA SOS.Chile.S1.500m, EOS.Chile.S1.500m    \n",
        "> ",
        "  sos_eosC <- st_as_stars(st_crop(st_as_stars(sos_eos),ndvi)) %>% st_set_dimensions(3,name = 'dates')",
        "> ",
        "sos_eosC",
        "stars object with 3 dimensions and 1 attribute\nattribute(s):\n         Min. 1st Qu. Median     Mean 3rd Qu.  Max.   NA's\nvalues  11925   12044  12135 12116.31   12187 12562 547792\ndimension(s):\n      from   to   offset    delta                refsys point                               values x/y\nx     6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S    NA                                 NULL [x]\ny     3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S    NA                                 NULL [y]\ndates    1",
        "    2       NA       NA                    NA    NA SOS.Chile.S1.500m, EOS.Chile.S1.500m    \n",
        "> ",
        "c(c(sosC,eosC,along = 'dates'),ndvi, along = 'dates')",
        "Error in combine_dimensions(dots, along_dim) : \n  dimensions of element 1 and 2 are not identical\n",
        "> ",
        "c(c(sos_eos,along = 'dates'),ndvi, along = 'dates')",
        "class       : SpatRaster \ndimensions  : 25708, 15152, 2  (nrow, ncol, nlyr)\nresolution  : 231.6564, 231.6564  (x, y)\nextent      : -1417787, 2092271, 2939166, 8894587  (xmin, xmax, ymin, ymax)\ncoord. ref. : WGS 84 / UTM zone 19S (EPSG:32719) \nsources     : memory  \n              spat_qNi8063UVAzJgDT_240442.tif  \nnames       : SOS.Chile.S1.500m, EOS.Chile.S1.500m \nmin values  :             11872,             12060 \nmax values  :             12407,             12599 \n",
        "Warning messages:\n",
        "1: [c,SpatRaster] skipped 1 object(s) that are not SpatRaster \n",
        "2: [c,SpatRaster] skipped 2 object(s) that are not SpatRaster \n",
        "> ",
        "c(c(sos_eosC,along = 'dates'),ndvi, along = 'dates')",
        "stars object with 3 dimensions and 1 attribute\nattribute(s), summary of first 1e+05 cells:\n         Min. 1st Qu. Median     Mean 3rd Qu.  Max.  NA's\nvalues  11941   12033  12043 12042.09   12053 12378 90104\ndimension(s):\n      from   to   offset    delta                refsys point                               values x/y\nx     6088 9168 -1417787  231.656 WGS 84 / UTM zone 19S    NA                                 NULL [x]\ny     3581 3680  8894587 -231.656 WGS 84 / UTM zone 19S    NA                                 NULL",
        " [y]\ndates    1  512       NA       NA                    NA    NA SOS.Chile.S1.500m, EOS.Chile.S1.500m    \n",
        "Warning message:\n",
        "In c.stars(sos_eosC, along = \"dates\") :",
        "\n ",
        " along argument ignored; maybe you wanted to use st_redimension?\n",
        "\nRestarting R session...\n\n"
    ]
}